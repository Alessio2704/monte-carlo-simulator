// --- Grammar for ValuaScript (v4 Corrected) ---

start: config_block assignment* output_block

config_block: "@iterations" "=" SIGNED_NUMBER -> iterations_setting
output_block: "@output" "=" CNAME           -> output_setting

// A single, unified assignment rule.
// The right-hand side is now a generic "expression".
?assignment: "let" CNAME "=" expression -> assignment

// An expression can be a literal value or a function call.
?expression: value | function_call

// A value is a literal (scalar or vector).
?value: SIGNED_NUMBER -> scalar_value
      | vector

// --- Reusable Rule Definitions ---
vector: "[" [SIGNED_NUMBER ("," SIGNED_NUMBER)*] "]"
function_call: CNAME "(" [arg ("," arg)*] ")"

?arg: SIGNED_NUMBER | CNAME | function_call

// --- Terminal Definitions ---
%import common.CNAME
%import common.SIGNED_NUMBER
%ignore COMMENT
COMMENT: /#.*/
%import common.WS
%ignore WS