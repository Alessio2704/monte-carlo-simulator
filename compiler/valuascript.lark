// --- Grammar for ValuaScript (V2.2 - String Literals) ---

// A script is a sequence of directives and assignments in any order.
start: (directive | assignment)*

// A generic directive like @name = value
directive: "@" CNAME "=" expression -> directive_setting

// The let assignment remains the same
assignment: "let" CNAME "=" expression -> assignment

// --- HIERARCHY FOR MATHEMATICAL EXPRESSIONS ---
?expression: term ((ADD|SUB) term)*         -> infix_expression
?term:       factor ((MUL|DIV) factor)*       -> infix_expression
?factor:     power
?power:      atom (POW atom)*            -> infix_expression

?atom: SIGNED_NUMBER
     | CNAME
     | STRING // Add string literals as a possible value
     | function_call
     | vector
     | "(" expression ")"

// --- Reusable Rule Definitions ---
vector: "[" [arg ("," arg)*] "]"
function_call: CNAME "(" [arg ("," arg)*] ")"
?arg: expression

// --- Terminal Definitions ---
ADD: "+"
SUB: "-"
MUL: "*"
DIV: "/"
POW: "^"

// A terminal for double-quoted strings
STRING: /"[^"]*"/

%import common.CNAME
%import common.SIGNED_NUMBER
%ignore COMMENT
COMMENT: /#.*/
%import common.WS
%ignore WS